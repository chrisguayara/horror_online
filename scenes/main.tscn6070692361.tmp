[gd_scene load_steps=33 format=3 uid="uid://ce44wurxmtn8p"]

[ext_resource type="PackedScene" uid="uid://bohs6vfsil5ho" path="res://scenes/player.tscn" id="1_o5qli"]
[ext_resource type="Script" uid="uid://ktw53yl65yqq" path="res://scripts/main.gd" id="1_sugp2"]
[ext_resource type="Script" uid="uid://dbw58v4iwg8nn" path="res://scripts/player/inventory.gd" id="3_tbgi4"]
[ext_resource type="Script" uid="uid://3gr5qrr16u8n" path="res://scripts/interactables/alarmclock.gd" id="6_o6xl0"]
[ext_resource type="PackedScene" uid="uid://dh3361yabq7es" path="res://assets/models/alarmclock.glb" id="6_tefeu"]
[ext_resource type="PackedScene" uid="uid://dr5qqbe8x18vn" path="res://assets/models/environment/testmodels/psx_abandoned_house.glb" id="7_yc10j"]
[ext_resource type="Script" uid="uid://c41nf80eu7g68" path="res://scripts/managers/soundmanager.gd" id="8_tipki"]
[ext_resource type="AudioStream" uid="uid://c72ym56mc7plj" path="res://assets/sound/soundfx/pickup.mp3" id="9_eb6dy"]
[ext_resource type="AudioStream" uid="uid://b3a350oki6al1" path="res://assets/sound/soundfx/playtest.mp3" id="9_ya4ey"]
[ext_resource type="AudioStream" uid="uid://bqobru71kjwc4" path="res://assets/sound/soundfx/objSounds/shotgun/shotgun_dryfire.wav" id="14_gqmmt"]
[ext_resource type="PackedScene" uid="uid://bn5eogv0c0lq8" path="res://assets/models/pickups/huntingRifle.tscn" id="16_muem4"]
[ext_resource type="PackedScene" uid="uid://tv8a6n2q7r0q" path="res://scenes/inWorld/hunting_rifle_inhand.tscn" id="17_dp3eg"]
[ext_resource type="Script" uid="uid://dd07vjbqihybk" path="res://scripts/killer/killerlogic.gd" id="17_muem4"]
[ext_resource type="PackedScene" uid="uid://cue3ni070rfje" path="res://scenes/pickups/remington_pickup.tscn" id="18_dp3eg"]
[ext_resource type="PackedScene" uid="uid://tdkn6oewacsk" path="res://scenes/pickups/tincantrap.tscn" id="19_0ld40"]
[ext_resource type="Shader" uid="uid://dbfcqo4xbdgpd" path="res://shaders/post_process.gdshader" id="20_gqmmt"]
[ext_resource type="Shader" uid="uid://14n5mtypncl5" path="res://shaders/crtscreen.gdshader" id="20_yc10j"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_sugp2"]
sky_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)
ground_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)

[sub_resource type="Sky" id="Sky_jyhfs"]
sky_material = SubResource("ProceduralSkyMaterial_sugp2")

[sub_resource type="Environment" id="Environment_tbgi4"]
background_mode = 2
sky = SubResource("Sky_jyhfs")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="PlaneMesh" id="PlaneMesh_jkv2x"]
size = Vector2(40, 40)

[sub_resource type="BoxShape3D" id="BoxShape3D_jkv2x"]
size = Vector3(32, 1, 38)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_yc10j"]
render_priority = 0
shader = ExtResource("20_gqmmt")
shader_parameter/dither_amount = 0.25

[sub_resource type="QuadMesh" id="QuadMesh_0ld40"]
flip_faces = true
size = Vector2(2, 2)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_o6xl0"]

[sub_resource type="BoxShape3D" id="BoxShape3D_tipki"]
size = Vector3(0.41037, 0.249512, 0.577576)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_toumy"]
height = 2.5

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_t7jvd"]
radius = 0.539474
height = 2.52312

[sub_resource type="NavigationMesh" id="NavigationMesh_muem4"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_jscy8"]
shader = ExtResource("20_yc10j")
shader_parameter/vignette_strength = 0.43
shader_parameter/saturation_boost = 1.48
shader_parameter/scanline_strength = 0.34

[sub_resource type="QuadMesh" id="QuadMesh_pm3ni"]
size = Vector2(1280, 960)
center_offset = Vector3(640, 480, 0)

[sub_resource type="ViewportTexture" id="ViewportTexture_muem4"]
viewport_path = NodePath("SubViewport")

[node name="Main" type="Node3D"]
script = ExtResource("1_sugp2")

[node name="SubViewport" type="SubViewport" parent="."]
use_occlusion_culling = true
size = Vector2i(640, 480)
render_target_update_mode = 4

[node name="WorldEnvironment" type="WorldEnvironment" parent="SubViewport"]
environment = SubResource("Environment_tbgi4")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="SubViewport"]
transform = Transform3D(-0.866024, -0.433016, 0.25, 0, 0.499998, 0.866027, -0.500003, 0.75, -0.43301, 0, 0, 0)
shadow_enabled = true

[node name="CanvasLayer" type="CanvasLayer" parent="SubViewport"]

[node name="Label" type="Label" parent="SubViewport/CanvasLayer"]
anchors_preset = 10
anchor_right = 1.0
offset_bottom = 23.0
grow_horizontal = 2
text = "MODE: "

[node name="floor" type="StaticBody3D" parent="SubViewport"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.1, 0)
collision_layer = 6
collision_mask = 7

[node name="floor" type="MeshInstance3D" parent="SubViewport/floor"]
mesh = SubResource("PlaneMesh_jkv2x")
skeleton = NodePath("../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="SubViewport/floor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.5, -0.5, 0.5)
shape = SubResource("BoxShape3D_jkv2x")
debug_color = Color(0.796758, 0.561828, 0.0723352, 0.42)

[node name="Items" type="Node3D" parent="SubViewport"]

[node name="RemingtonPickup" parent="SubViewport/Items" instance=ExtResource("18_dp3eg")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.1, 1, 3.8)
item_pickup = "shotGun_Pickup"

[node name="Area3D" parent="SubViewport/Items" instance=ExtResource("19_0ld40")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 0.5, 4.9)

[node name="player" parent="SubViewport" instance=ExtResource("1_o5qli")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 2, 3.74523)

[node name="camera" parent="SubViewport/player/head" index="0"]
keep_aspect = 0

[node name="hand" parent="SubViewport/player/head/camera" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.4, -0.5, -1.1)

[node name="postFX" type="MeshInstance3D" parent="SubViewport/player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, -2, -3.74523)
material_override = SubResource("ShaderMaterial_yc10j")
extra_cull_margin = 16384.0
mesh = SubResource("QuadMesh_0ld40")
skeleton = NodePath("../../..")

[node name="inventory" type="Node3D" parent="SubViewport/player"]
script = ExtResource("3_tbgi4")

[node name="HuntingRifle" parent="SubViewport" instance=ExtResource("16_muem4")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.8, 1.1, 0)
item_scene = ExtResource("17_dp3eg")

[node name="Sketchfab_Scene" parent="SubViewport" instance=ExtResource("7_yc10j")]
transform = Transform3D(0.866025, 0, 0.5, 0, 1, 0, -0.5, 0, 0.866025, 4, 0, -2)

[node name="alarmclock" type="StaticBody3D" parent="SubViewport"]
transform = Transform3D(-0.271184, 0, 0.42007, 0, 0.5, 0, -0.42007, 0, -0.271184, -1.37581, 0.504935, -0.157654)
physics_material_override = SubResource("PhysicsMaterial_o6xl0")
script = ExtResource("6_o6xl0")
prompt_msg = "Set Alarm"

[node name="alarmclock" parent="SubViewport/alarmclock" instance=ExtResource("6_tefeu")]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, 3.51928, 1, -3.08577)

[node name="CollisionShape3D" type="CollisionShape3D" parent="SubViewport/alarmclock"]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, 1.77916, 1.14826, -1.50337)
shape = SubResource("BoxShape3D_tipki")

[node name="Soundmanager" type="Node3D" parent="SubViewport" node_paths=PackedStringArray("alarm_node", "inventory_node", "shotGun_PU_node")]
script = ExtResource("8_tipki")
alarm_node = NodePath("alarm")
inventory_node = NodePath("Pickup")
shotGun_PU_node = NodePath("shotGun_Pickup")

[node name="Pickup" type="AudioStreamPlayer" parent="SubViewport/Soundmanager"]
stream = ExtResource("9_eb6dy")
volume_db = 8.0

[node name="alarm" type="AudioStreamPlayer" parent="SubViewport/Soundmanager"]
stream = ExtResource("9_ya4ey")
volume_db = 2.734

[node name="shotGun_Pickup" type="AudioStreamPlayer" parent="SubViewport/Soundmanager"]
stream = ExtResource("14_gqmmt")
volume_db = -6.09

[node name="axekiller" type="CharacterBody3D" parent="SubViewport" node_paths=PackedStringArray("player")]
script = ExtResource("17_muem4")
player = NodePath("../player")

[node name="MeshInstance3D" type="MeshInstance3D" parent="SubViewport/axekiller"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.2296, 0)
mesh = SubResource("CapsuleMesh_toumy")

[node name="CollisionShape3D" type="CollisionShape3D" parent="SubViewport/axekiller"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.2105, 0)
shape = SubResource("CapsuleShape3D_t7jvd")

[node name="Timer" type="Timer" parent="SubViewport/axekiller"]
wait_time = 5.964
one_shot = true

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="SubViewport/axekiller"]
navigation_mesh = SubResource("NavigationMesh_muem4")

[node name="CanvasLayer2" type="CanvasLayer" parent="."]

[node name="MeshInstance2D" type="MeshInstance2D" parent="CanvasLayer2"]
material = SubResource("ShaderMaterial_jscy8")
mesh = SubResource("QuadMesh_pm3ni")

[node name="lowres" type="TextureRect" parent="."]
texture_filter = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_muem4")
stretch_mode = 4

[connection signal="activeInHand" from="SubViewport/player/inventory" to="SubViewport/player/head/camera/hand" method="_on_inventory_active_in_hand"]
[connection signal="addSound" from="SubViewport/player/inventory" to="SubViewport/Soundmanager" method="_on_inventory_add_sound"]
[connection signal="playsound" from="SubViewport/alarmclock" to="SubViewport/Soundmanager" method="_on_alarmclock_playsound"]
[connection signal="timeout" from="SubViewport/axekiller/Timer" to="SubViewport/axekiller" method="_on_timer_timeout"]
[connection signal="timeout" from="SubViewport/axekiller/Timer" to="SubViewport/axekiller" method="_on_Timer_timeout"]

[editable path="SubViewport/player"]
